<html>
    <head>
        <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAhydT0Kt-vmdCL2805ijP2M2A0m7G16zk&sensor=false" type="text/javascript"></script>
        <script src="http://code.jquery.com/jquery-2.0.3.min.js" type="text/javascript"></script>
        <script src="GeoJSON.js" type="text/javascript"></script>

        <script type="text/javascript">
            var map = null;

            function initialize () {
                var mapOptions = {
                    center : new google.maps.LatLng(40.7566, -73.9863),
                    zoom : 13,
                    mapTypeId : google.maps.MapTypeId.SATELLITE,
                };

                map = new google.maps.Map($('#map').get(0), mapOptions);
                map.setTilt (0);

                var dataset = 'cudtrt13triphammercu';
                //var dataset = 'airportloop';

                /* 
                $.getJSON ('/'+dataset+'/kalman_time_varying_0.1', function (data) { load_geojson(data, 'red'); })
                    .fail(geojson_failure);

                $.getJSON ('/'+dataset+'/kalman_time_varying_1', function (data) { load_geojson(data, 'green'); })
                    .fail(geojson_failure);
                */

                $.getJSON ('/'+dataset+'/kalman_time_varying_10', function (data) { load_geojson(data, 'blue'); })
                    .fail(geojson_failure);

                $.getJSON ('/'+dataset+'/absolute', function (data) { load_geojson(data, 'yellow'); })
                    .fail(geojson_failure);

                /*
                $.getJSON ('/'+dataset+'/integrate', function (data) { load_geojson(data, 'magenta'); })
                    .fail(geojson_failure);
                */


            }

            function load_geojson (data, color) {
                console.log('success')

                map.setCenter(new google.maps.LatLng(
                    data.geometry.coordinates[0][0][1], 
                    data.geometry.coordinates[0][0][0]
                ));

                var googleOptions = {
                    strokeColor: color,
                    strokeOpacity: 0.8,
                    strokeWeight: 2,
                };

                var googleMapsVector = new GeoJSON(data, googleOptions);

                $.each(googleMapsVector, function (k, v) {
                    v.setMap(map);
                });
            }

            function geojson_failure (data) {
                console.log('Failure');
                console.log(data);
            }

            $(document).ready(initialize);
        </script>
    </head>
    <body>
        <div id="map" style="height:100%;width:100%">
        </div>
    </body>
</html>
